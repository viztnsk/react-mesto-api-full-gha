{"ast":null,"code":"import { BASE_URL } from './auth';\nclass Api {\n  constructor(_ref) {\n    let {\n      url,\n      ...options\n    } = _ref;\n    this._url = url;\n    this._options = options;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n  setToken(token) {\n    localStorage.setItem('token', token);\n    if (!this._options.headers) this._options.headers = {};\n    this._options.headers.authorization = \"Bearer \" + token;\n  }\n  // removeToken() {\n  //   localStorage.removeItem('token')\n  //   if (this._options?.headers?.authorization) {\n  //     delete this._options?.headers?.authorization;\n  //   }\n  // }\n\n  async _fetch(path) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 ? arguments[2] : undefined;\n    const opt = {\n      ...this._options,\n      method\n    };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body;\n      } else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt);\n    if (res.ok) {\n      return res.json();\n    } else {\n      return Promise.reject(`Ошибка: ${JSON.message}`);\n    }\n  }\n  getCards() {\n    return this._fetch('/cards', \"GET\");\n  }\n  getUser() {\n    return this._fetch('/users/me', \"GET\");\n  }\n  patchUser(values) {\n    return this._fetch('/users/me', 'PATCH', values);\n  }\n  setAvatar(avatar) {\n    return this._fetch('/users/me/avatar', 'PATCH', avatar);\n  }\n  addCard(_ref2) {\n    let {\n      name,\n      link\n    } = _ref2;\n    return this._fetch('/cards', \"POST\", {\n      name,\n      link\n    });\n  }\n  deleteCard(card) {\n    return this._fetch(`/cards/${card._id}`, \"DELETE\");\n  }\n  setLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"PUT\");\n  }\n  removeLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"DELETE\");\n  }\n  changeLikeCardStatus(cardId, isLiked) {\n    if (isLiked) {\n      return this._fetch(`/cards/${cardId}/likes`, \"PUT\");\n    } else {\n      return this._fetch(`/cards/${cardId}/likes`, \"DELETE\");\n    }\n  }\n}\nconst api = new Api({\n  url: BASE_URL,\n  headers: {\n    authorization: `Bearer ${localStorage.getItem('token')}`,\n    'Content-Type': 'application/json'\n  }\n});\nexport default api;","map":{"version":3,"names":["BASE_URL","Api","constructor","url","options","_url","_options","token","localStorage","getItem","headers","authorization","setToken","setItem","_fetch","path","method","body","opt","JSON","stringify","res","fetch","ok","json","Promise","reject","message","getCards","getUser","patchUser","values","setAvatar","avatar","addCard","name","link","deleteCard","card","_id","setLike","removeLike","changeLikeCardStatus","cardId","isLiked","api"],"sources":["/Users/user/Desktop/react-mesto-api-full-gha/frontend/src/utils/Api.js"],"sourcesContent":["import { BASE_URL } from './auth';\n\nclass Api {\n  constructor({url, ...options}) {\n    this._url = url;\n    this._options = options;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n\n  setToken(token) {\n    localStorage.setItem('token', token);\n    if (!this._options.headers) this._options.headers = {};\n    this._options.headers.authorization = \"Bearer \" + token;\n  }\n  // removeToken() {\n  //   localStorage.removeItem('token')\n  //   if (this._options?.headers?.authorization) {\n  //     delete this._options?.headers?.authorization;\n  //   }\n  // }\n\n  async _fetch(path, method='GET', body) {\n    const opt = { ...this._options, method };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body; \n      }\n      else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt)\n    if(res.ok) {\n      return res.json()\n    }\n    else {\n      return Promise.reject(`Ошибка: ${JSON.message}`)\n    }\n  }\n    getCards() {\n      return this._fetch('/cards', \"GET\");\n    }\n    getUser() {\n      return this._fetch('/users/me', \"GET\");\n    }\n    patchUser(values) {\n      return this._fetch('/users/me', 'PATCH', values)\n    }\n    setAvatar(avatar) {\n      return this._fetch('/users/me/avatar', 'PATCH', avatar)\n    }\n    addCard({name, link}) {\n      return this._fetch('/cards', \"POST\", {name, link})\n    }\n    deleteCard(card) {\n      return this._fetch(`/cards/${card._id}`, \"DELETE\")\n    }\n    setLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"PUT\")\n    }\n    removeLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"DELETE\")\n    }\n    changeLikeCardStatus(cardId, isLiked) {\n      if (isLiked) {\n        return this._fetch(`/cards/${cardId}/likes`, \"PUT\")\n      }\n      else {\n        return this._fetch(`/cards/${cardId}/likes`, \"DELETE\")\n      }\n    }\n  }\nconst api = new Api ({\n    url: BASE_URL,\n    headers: {\n      authorization: `Bearer ${localStorage.getItem('token')}`,\n      'Content-Type': 'application/json'\n    }\n  })\n  export default api"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}