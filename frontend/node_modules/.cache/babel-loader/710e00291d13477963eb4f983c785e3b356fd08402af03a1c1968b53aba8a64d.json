{"ast":null,"code":"import { BASE_URL } from './auth';\nclass Api {\n  constructor(_ref) {\n    let {\n      url,\n      credentials,\n      ...options\n    } = _ref;\n    this._url = url;\n    this.options = options;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n  setToken(token) {\n    localStorage.setItem('token', token);\n    if (!this._options.headers) this._options.headers = {};\n    this._options.headers.authorization = \"Bearer \" + token;\n  }\n  removeToken(token) {\n    var _this$_options, _this$_options$header;\n    localStorage.removeItem('token');\n    if ((_this$_options = this._options) !== null && _this$_options !== void 0 && (_this$_options$header = _this$_options.headers) !== null && _this$_options$header !== void 0 && _this$_options$header.authorization) {\n      var _this$_options2, _this$_options2$heade;\n      (_this$_options2 = this._options) === null || _this$_options2 === void 0 ? true : (_this$_options2$heade = _this$_options2.headers) === null || _this$_options2$heade === void 0 ? true : delete _this$_options2$heade.authorization;\n    }\n  }\n  async _fetch(path) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 ? arguments[2] : undefined;\n    const opt = {\n      ...this._headers,\n      method\n    };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body;\n      } else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt);\n    console.log(res);\n    if (res.ok) {\n      return res.json();\n    } else {\n      return Promise.reject(`Ошибка: ${JSON.message}`);\n    }\n  }\n  getCards() {\n    return this._fetch('/cards', \"GET\");\n  }\n  getUser() {\n    return this._fetch('/users/me', \"GET\");\n  }\n  patchUser(values) {\n    return this._fetch('/users/me', 'PATCH', values);\n  }\n  setAvatar(avatar) {\n    return this._fetch('/users/me/avatar', 'PATCH', avatar);\n  }\n  addCard(_ref2) {\n    let {\n      name,\n      link\n    } = _ref2;\n    return this._fetch('/cards', \"POST\", {\n      name,\n      link\n    });\n  }\n  deleteCard(card) {\n    return this._fetch(`/cards/${card._id}`, \"DELETE\");\n  }\n  setLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"PUT\");\n  }\n  removeLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"DELETE\");\n  }\n  changeLikeCardStatus(cardId, isLiked) {\n    if (isLiked) {\n      return this._fetch(`/cards/${cardId}/likes`, \"PUT\");\n    } else {\n      return this._fetch(`/cards/${cardId}/likes`, \"DELETE\");\n    }\n  }\n}\nconst api = new Api({\n  url: BASE_URL,\n  credentials: 'include',\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nexport default api;","map":{"version":3,"names":["BASE_URL","Api","constructor","url","credentials","options","_url","token","localStorage","getItem","_options","headers","authorization","setToken","setItem","removeToken","removeItem","_fetch","path","method","body","opt","_headers","JSON","stringify","res","fetch","console","log","ok","json","Promise","reject","message","getCards","getUser","patchUser","values","setAvatar","avatar","addCard","name","link","deleteCard","card","_id","setLike","removeLike","changeLikeCardStatus","cardId","isLiked","api"],"sources":["/Users/user/Desktop/react-mesto-api-full-gha/frontend/src/utils/Api.js"],"sourcesContent":["import { BASE_URL } from './auth';\n\nclass Api {\n  constructor({url, credentials, ...options}) {\n    this._url = url;\n    this.options = options;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n\n  setToken(token) {\n    localStorage.setItem('token', token);\n    if (!this._options.headers) this._options.headers = {};\n    this._options.headers.authorization = \"Bearer \" + token;\n  }\n  removeToken(token) {\n    localStorage.removeItem('token')\n    if (this._options?.headers?.authorization) {\n      delete this._options?.headers?.authorization;\n    }\n  }\n  \n\n  async _fetch(path, method='GET', body) {\n    const opt = { ...this._headers, method };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body; \n      }\n      else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt)\n    console.log(res)\n    if(res.ok) {\n      return res.json()\n    }\n    else {\n      return Promise.reject(`Ошибка: ${JSON.message}`)\n    }\n  }\n    getCards() {\n      return this._fetch('/cards', \"GET\");\n    }\n    getUser() {\n      return this._fetch('/users/me', \"GET\");\n    }\n    patchUser(values) {\n      return this._fetch('/users/me', 'PATCH', values)\n    }\n    setAvatar(avatar) {\n      return this._fetch('/users/me/avatar', 'PATCH', avatar)\n    }\n    addCard({name, link}) {\n      return this._fetch('/cards', \"POST\", {name, link})\n    }\n    deleteCard(card) {\n      return this._fetch(`/cards/${card._id}`, \"DELETE\")\n    }\n    setLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"PUT\")\n    }\n    removeLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"DELETE\")\n    }\n    changeLikeCardStatus(cardId, isLiked) {\n      if (isLiked) {\n        return this._fetch(`/cards/${cardId}/likes`, \"PUT\")\n      }\n      else {\n        return this._fetch(`/cards/${cardId}/likes`, \"DELETE\")\n      }\n    }\n  }\nconst api = new Api ({\n    url: BASE_URL,\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n  export default api"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}