{"ast":null,"code":"import { BASE_URL } from './auth';\nclass Api {\n  constructor(_ref) {\n    let {\n      url,\n      credentials,\n      ...headers\n    } = _ref;\n    this._url = url;\n    this._headers = headers;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n  async _fetch(path) {\n    let method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'GET';\n    let body = arguments.length > 2 ? arguments[2] : undefined;\n    const opt = {\n      ...this._headers,\n      method\n    };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body;\n      } else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt);\n    console.log(res);\n    if (res.ok) {\n      return res.json();\n    } else {\n      return Promise.reject(`Ошибка: ${JSON.message}`);\n    }\n  }\n  getCards() {\n    return this._fetch('/cards', \"GET\");\n  }\n  getUser() {\n    return this._fetch('/users/me', \"GET\");\n  }\n  patchUser(values) {\n    return this._fetch('/users/me', 'PATCH', values);\n  }\n  setAvatar(avatar) {\n    return this._fetch('/users/me/avatar', 'PATCH', avatar);\n  }\n  addCard(_ref2) {\n    let {\n      name,\n      link\n    } = _ref2;\n    return this._fetch('/cards', \"POST\", {\n      name,\n      link\n    });\n  }\n  deleteCard(card) {\n    return this._fetch(`/cards/${card._id}`, \"DELETE\");\n  }\n  setLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"PUT\");\n  }\n  removeLike(card) {\n    return this._fetch(`/cards/${card._id}/likes`, \"DELETE\");\n  }\n  changeLikeCardStatus(cardId, isLiked) {\n    if (isLiked) {\n      return this._fetch(`/cards/${cardId}/likes`, \"PUT\");\n    } else {\n      return this._fetch(`/cards/${cardId}/likes`, \"DELETE\");\n    }\n  }\n}\nconst api = new Api({\n  url: BASE_URL,\n  credentials: 'include',\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nexport default api;","map":{"version":3,"names":["BASE_URL","Api","constructor","url","credentials","headers","_url","_headers","token","localStorage","getItem","_options","authorization","_fetch","path","method","body","opt","JSON","stringify","res","fetch","console","log","ok","json","Promise","reject","message","getCards","getUser","patchUser","values","setAvatar","avatar","addCard","name","link","deleteCard","card","_id","setLike","removeLike","changeLikeCardStatus","cardId","isLiked","api"],"sources":["/Users/user/Desktop/react-mesto-api-full-gha/frontend/src/utils/Api.js"],"sourcesContent":["import { BASE_URL } from './auth';\n\nclass Api {\n  constructor({url, credentials, ...headers}) {\n    this._url = url;\n    this._headers = headers;\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      if (!this._options.headers) this._options.headers = {};\n      this._options.headers.authorization = \"Bearer \" + token;\n    }\n  }\n  \n\n  async _fetch(path, method='GET', body) {\n    const opt = { ...this._headers, method };\n    if (body) {\n      if (typeof body === 'string') {\n        opt.body = body; \n      }\n      else {\n        opt.body = JSON.stringify(body);\n      }\n    }\n    const res = await fetch(this._url + path, opt)\n    console.log(res)\n    if(res.ok) {\n      return res.json()\n    }\n    else {\n      return Promise.reject(`Ошибка: ${JSON.message}`)\n    }\n  }\n    getCards() {\n      return this._fetch('/cards', \"GET\");\n    }\n    getUser() {\n      return this._fetch('/users/me', \"GET\");\n    }\n    patchUser(values) {\n      return this._fetch('/users/me', 'PATCH', values)\n    }\n    setAvatar(avatar) {\n      return this._fetch('/users/me/avatar', 'PATCH', avatar)\n    }\n    addCard({name, link}) {\n      return this._fetch('/cards', \"POST\", {name, link})\n    }\n    deleteCard(card) {\n      return this._fetch(`/cards/${card._id}`, \"DELETE\")\n    }\n    setLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"PUT\")\n    }\n    removeLike(card) {\n      return this._fetch(`/cards/${card._id}/likes`, \"DELETE\")\n    }\n    changeLikeCardStatus(cardId, isLiked) {\n      if (isLiked) {\n        return this._fetch(`/cards/${cardId}/likes`, \"PUT\")\n      }\n      else {\n        return this._fetch(`/cards/${cardId}/likes`, \"DELETE\")\n      }\n    }\n  }\nconst api = new Api ({\n    url: BASE_URL,\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  })\n  export default api"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}